{"version":3,"sources":["../src/types.ts"],"sourcesContent":["import {\n  ExecuteTransactionRequestType,\n  SuiTransactionBlockResponseOptions,\n} from '@mysten/sui.js/client'\nimport { TransactionBlock } from '@mysten/sui.js/transactions'\nimport { fromB64, toB64 } from '@mysten/sui.js/utils'\nimport {\n  SuiSignAndExecuteTransactionBlockInput,\n  SuiSignPersonalMessageInput,\n  SuiSignTransactionBlockInput,\n  WalletAccount,\n  WalletIcon,\n} from '@mysten/wallet-standard'\nimport {\n  Infer,\n  Describe,\n  array,\n  object,\n  optional,\n  string,\n  boolean,\n  literal,\n  union,\n} from 'superstruct'\n\nexport { is, validate } from 'superstruct'\n\n/**\n * Passing in objects directly to the Snap sometimes doesn't work correctly so we need to serialize to primitive values\n * and then deserialize on the other side.\n */\n\n/* ======== SerializedWalletAccount ======== */\n\nexport const SerializedWalletAccount = object({\n  address: string(),\n  publicKey: string(),\n  chains: array(string()),\n  features: array(string()),\n  label: optional(string()),\n  icon: optional(string()),\n})\n\nexport type SerializedWalletAccount = Infer<typeof SerializedWalletAccount>\n\nexport function serializeWalletAccount(account: WalletAccount): SerializedWalletAccount {\n  return {\n    address: account.address,\n    publicKey: toB64(account.publicKey),\n    features: [...account.features],\n    chains: [...account.chains],\n    label: account.label,\n    icon: account.icon,\n  }\n}\n\nexport function deserializeWalletAccount(account: SerializedWalletAccount): WalletAccount {\n  return {\n    address: account.address,\n    publicKey: fromB64(account.publicKey),\n    chains: account.chains.map(chain => chain as `${string}:${string}`),\n    features: account.features.map(feature => feature as `${string}:${string}`),\n    label: account.label,\n    icon: account.icon as WalletIcon,\n  }\n}\n\n/* ======== SerializedSuiSignMessageInput ======== */\n\nexport const SerializedSuiSignPersonalMessageInput = object({\n  message: string(),\n  account: SerializedWalletAccount,\n})\n\nexport type SerializedSuiSignMessageInput = Infer<typeof SerializedSuiSignPersonalMessageInput>\n\nexport function serializeSuiSignMessageInput(\n  input: SuiSignPersonalMessageInput\n): SerializedSuiSignMessageInput {\n  return {\n    message: toB64(input.message),\n    account: serializeWalletAccount(input.account),\n  }\n}\n\nexport function deserializeSuiSignMessageInput(\n  input: SerializedSuiSignMessageInput\n): SuiSignPersonalMessageInput {\n  return {\n    message: fromB64(input.message),\n    account: deserializeWalletAccount(input.account),\n  }\n}\n\n/* ======== SerializedSuiSignTransactionBlockInput ======== */\n\nexport const SerializedSuiSignTransactionBlockInput = object({\n  transactionBlock: string(),\n  account: SerializedWalletAccount,\n  chain: string(),\n})\n\nexport type SerializedSuiSignTransactionBlockInput = Infer<\n  typeof SerializedSuiSignTransactionBlockInput\n>\n\nexport function serializeSuiSignTransactionBlockInput(\n  input: SuiSignTransactionBlockInput\n): SerializedSuiSignTransactionBlockInput {\n  return {\n    transactionBlock: input.transactionBlock.serialize(),\n    account: serializeWalletAccount(input.account),\n    chain: input.chain,\n  }\n}\n\nexport function deserializeSuiSignTransactionBlockInput(\n  input: SerializedSuiSignTransactionBlockInput\n): SuiSignTransactionBlockInput {\n  return {\n    transactionBlock: TransactionBlock.from(input.transactionBlock),\n    account: deserializeWalletAccount(input.account),\n    chain: input.chain as `${string}:${string}`,\n  }\n}\n\n/* ======== SerializedSuiSignAndExecuteTransactionBlockInput ======== */\n\nconst SuiTransactionBlockResponseOptions: Describe<SuiTransactionBlockResponseOptions> = object({\n  showBalanceChanges: optional(boolean()),\n  showEffects: optional(boolean()),\n  showEvents: optional(boolean()),\n  showInput: optional(boolean()),\n  showObjectChanges: optional(boolean()),\n  showRawInput: optional(boolean()),\n})\n\nexport const SerializedSuiSignAndExecuteTransactionBlockInput = object({\n  transactionBlock: string(),\n  account: SerializedWalletAccount,\n  chain: string(),\n  requestType: optional(string()),\n  options: optional(SuiTransactionBlockResponseOptions),\n})\n\nexport type SerializedSuiSignAndExecuteTransactionBlockInput = Infer<\n  typeof SerializedSuiSignAndExecuteTransactionBlockInput\n>\n\nexport function serializeSuiSignAndExecuteTransactionBlockInput(\n  input: SuiSignAndExecuteTransactionBlockInput\n): SerializedSuiSignAndExecuteTransactionBlockInput {\n  return {\n    transactionBlock: input.transactionBlock.serialize(),\n    account: serializeWalletAccount(input.account),\n    chain: input.chain,\n    requestType: input.requestType,\n    options: input.options,\n  }\n}\n\nexport function deserializeSuiSignAndExecuteTransactionBlockInput(\n  input: SerializedSuiSignAndExecuteTransactionBlockInput\n): SuiSignAndExecuteTransactionBlockInput {\n  return {\n    ...input,\n    transactionBlock: TransactionBlock.from(input.transactionBlock),\n    account: deserializeWalletAccount(input.account),\n    chain: input.chain as `${string}:${string}`,\n    requestType: input.requestType as ExecuteTransactionRequestType | undefined,\n  }\n}\n\n/* ======== StoredState ======== */\n\nexport interface StoredState {\n  mainnetUrl: string\n  testnetUrl: string\n  devnetUrl: string\n  localnetUrl: string\n}\n\n/* ======== SerializedAdminSetFullnodeUrl ======== */\n\nexport const SerializedAdminSetFullnodeUrl = object({\n  network: union([literal('mainnet'), literal('testnet'), literal('devnet'), literal('localnet')]),\n  url: string(),\n})\n\nexport type SerializedAdminSetFullnodeUrl = Infer<typeof SerializedAdminSetFullnodeUrl>\n"],"mappings":"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","names":[]}